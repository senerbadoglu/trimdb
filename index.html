<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRimdb | Profesyonel Film Rehberi</title>
    <style>
        :root { --main: #f5c518; --bg: #121212; --card: #1c1c1c; --input-bg: #2a2a2a; }
        body { background: #000; color: white; font-family: 'Inter', -apple-system, sans-serif; margin: 0; overflow-x: hidden; }
        header { background: #121212; padding: 15px 5%; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; position: sticky; top: 0; z-index: 1000; }
        .logo { color: var(--main); font-weight: 900; font-size: 26px; text-decoration: none; border: 2.5px solid var(--main); padding: 4px 12px; border-radius: 6px; letter-spacing: -1px; transition: 0.3s; }
        .logo:hover { background: var(--main); color: black; }
        .header-right { display: flex; align-items: center; gap: 20px; }
        .colors { display: flex; gap: 10px; }
        .dot { width: 18px; height: 18px; border-radius: 50%; cursor: pointer; border: 2px solid #fff; transition: 0.2s; }
        .dot:hover { transform: scale(1.2); }
        .robot-panel { background: var(--bg); padding: 25px 5%; border-bottom: 1px solid #333; }
        .robot-title { font-size: 18px; font-weight: bold; margin-bottom: 20px; color: #fff; display: flex; align-items: center; gap: 10px; }
        .robot-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; }
        .filter-item { background: var(--input-bg); padding: 12px; border-radius: 10px; border: 1px solid #333; }
        .filter-item label { display: block; font-size: 11px; color: #aaa; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 1px; }
        .filter-item select { width: 100%; background: transparent; color: white; border: none; outline: none; font-size: 15px; cursor: pointer; font-weight: 500; appearance: none; }
        .filter-item select option { background: #2a2a2a; color: white; }
        .run-btn { background: var(--main); color: black; border: none; padding: 15px; border-radius: 10px; font-weight: 800; cursor: pointer; width: 100%; margin-top: 20px; font-size: 14px; text-transform: uppercase; transition: 0.3s; box-shadow: 0 4px 15px rgba(245, 197, 24, 0.2); }
        .run-btn:hover { background: #fff; transform: translateY(-2px); }
        .movie-grid { padding: 30px 5%; display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 25px; }
        .movie-card { background: var(--card); border-radius: 15px; overflow: hidden; position: relative; transition: 0.4s; border: 1px solid #222; }
        .movie-card:hover { transform: translateY(-10px); border-color: var(--main); box-shadow: 0 10px 30px rgba(0,0,0,0.7); }
        .movie-card img { width: 100%; height: 270px; object-fit: cover; cursor: pointer; }
        .rating-badge { position: absolute; top: 12px; right: 12px; background: rgba(0,0,0,0.85); color: var(--main); padding: 4px 8px; border-radius: 6px; font-size: 12px; font-weight: bold; backdrop-filter: blur(5px); pointer-events: none; }
        .movie-info { padding: 15px; }
        .movie-info h3 { margin: 0; font-size: 14px; height: 40px; overflow: hidden; line-height: 1.4; color: #eee; }
        .play-btn { background: #e50914; color: white; border: none; width: 100%; padding: 10px; border-radius: 8px; font-weight: bold; margin-top: 10px; cursor: pointer; transition: 0.3s; }
        .play-btn:hover { background: #ff0000; }
        .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:9999; }
        .modal-inner { width: 90%; max-width: 900px; margin: 4% auto; position: relative; }
        .video-ratio { position: relative; padding-bottom: 56.25%; height: 0; background: #000; border-radius: 15px; overflow: hidden; }
        .video-ratio iframe { position: absolute; top:0; left:0; width:100%; height:100%; border:0; }
        .close-modal { position: absolute; right: -40px; top: -40px; font-size: 40px; color: white; cursor: pointer; }
        @media (max-width: 768px) { .robot-grid { grid-template-columns: 1fr 1fr; } .close-modal { right: 0; top: -50px; } }
    </style>
</head>
<body>

<header>
    <a href="#" class="logo" onclick="location.reload()">TRimdb</a>
    <div class="header-right">
        <div class="colors">
            <div class="dot" style="background: #f5c518;" onclick="changeTheme('#f5c518')"></div>
            <div class="dot" style="background: #ff4757;" onclick="changeTheme('#ff4757')"></div>
            <div class="dot" style="background: #1e90ff;" onclick="changeTheme('#1e90ff')"></div>
        </div>
        <select id="ui-lang" onchange="initApp(false)" style="background:#333; color:white; border:none; padding:5px 10px; border-radius:5px; cursor:pointer;">
            <option value="tr-TR">T√ºrk√ße</option>
            <option value="en-US">English</option>
        </select>
    </div>
</header>

<div class="robot-panel">
    <div class="robot-title">üîç Geli≈ümi≈ü Filtreleme</div>
    <div class="robot-grid">
        <div class="filter-item">
            <label>T√ºrler</label>
            <select id="genre-id">
                <option value="">T√ºm T√ºrler</option>
                <option value="28">Aksiyon</option><option value="12">Macera</option><option value="16">Animasyon</option><option value="35">Komedi</option><option value="80">Su√ß</option><option value="18">Dram</option><option value="27">Korku</option><option value="878">Bilim Kurgu</option>
            </select>
        </div>
        <div class="filter-item">
            <label>Yƒ±llar</label>
            <select id="year-val">
                <option value="">T√ºm Yƒ±llar</option>
                <option value="2025">2025</option><option value="2024">2024</option><option value="2023">2023</option><option value="2022">2022</option><option value="2021">2021</option><option value="2020">2020</option><option value="2019">2019</option><option value="2018">2018</option><option value="2017">2017</option><option value="2016">2016</option><option value="2015">2015</option><option value="2014">2014</option><option value="2013">2013</option><option value="2012">2012</option><option value="2011">2011</option><option value="2010">2010</option><option value="2009">2009</option><option value="2008">2008</option><option value="2007">2007</option><option value="2006">2006</option><option value="2005">2005</option><option value="2004">2004</option><option value="2003">2003</option><option value="2002">2002</option><option value="2001">2001</option><option value="2000-old">2000 √ñncesi</option>
            </select>
        </div>
        <div class="filter-item">
            <label>TRimdb Puanƒ±</label>
            <select id="vote-val">
                <option value="0">T√úM PUANLAR</option>
                <option value="10">10 Puan</option>
                <option value="9">9+ √úzeri</option>
                <option value="8">8+ √úzeri</option>
                <option value="7">7+ √úzeri</option>
                <option value="6">6+ √úzeri</option>
                <option value="5">5+ √úzeri</option>
                <option value="4">4+ √úzeri</option>
                <option value="3">3+ √úzeri</option>
                <option value="2">2+ √úzeri</option>
                <option value="1">1+ √úzeri</option>
            </select>
        </div>
        <div class="filter-item">
            <label>Sƒ±ralama</label>
            <select id="sort-val">
                <option value="popularity.desc">Pop√ºlerlik</option>
                <option value="vote_average.desc">Puan (Y√ºksek)</option>
                <option value="primary_release_date.desc">Yeni Tarih</option>
            </select>
        </div>
    </div>
    <button class="run-btn" onclick="initApp(false)">Robotu √áalƒ±≈ütƒ±r</button>
</div>

<div class="movie-grid" id="grid"></div>

<div style="text-align:center; padding-bottom: 60px;">
    <button class="run-btn" style="width: 280px;" onclick="loadMore()">Daha Fazla Film Getir</button>
</div>

<div id="v-modal" class="modal">
    <div class="modal-inner">
        <span class="close-modal" onclick="closeVideo()">&times;</span>
        <div id="player" class="video-ratio"></div>
    </div>
</div>

<script>
    const API_KEY = '5157610ea853936f008717feb19e6a9f';
    let currentPage = 1;

    function changeTheme(c) { document.documentElement.style.setProperty('--main', c); }

    async function initApp(isRandom = true) {
        if(isRandom) {
            currentPage = Math.floor(Math.random() * 20) + 1; 
        } else {
            currentPage = 1;
        }
        document.getElementById('grid').innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:50px; color:var(--main);">Robot ar≈üivleri tarƒ±yor...</div>';
        await fetchMovies();
    }

    async function fetchMovies() {
        const genre = document.getElementById('genre-id').value;
        const yearSelect = document.getElementById('year-val').value;
        const vote = document.getElementById('vote-val').value;
        const sort = document.getElementById('sort-val').value;
        const lang = document.getElementById('ui-lang').value;
        const cache = new Date().getTime();

        let url = `https://api.themoviedb.org/3/discover/movie?api_key=${API_KEY}&language=${lang}&page=${currentPage}&sort_by=${sort}&vote_average.gte=${vote}&cb=${cache}`;
        
        if(genre) url += `&with_genres=${genre}`;
        if(yearSelect === "2000-old") {
            url += `&release_date.lte=1999-12-31`;
        } else if(yearSelect) {
            url += `&primary_release_year=${yearSelect}`;
        }

        try {
            const res = await fetch(url);
            const data = await res.json();
            if(currentPage === 1 || document.getElementById('grid').innerText.includes('tarƒ±yor')) document.getElementById('grid').innerHTML = '';
            render(data.results);
        } catch (e) { console.error("Hata!"); }
    }

    function render(movies) {
        const container = document.getElementById('grid');
        movies.forEach(m => {
            if(!m.poster_path) return;
            const card = document.createElement('div');
            card.className = 'movie-card';
            card.innerHTML = `<div class="rating-badge">‚òÖ ${m.vote_average.toFixed(1)}</div><img src="https://image.tmdb.org/t/p/w500${m.poster_path}" onclick="openVideo(${m.id})"><div class="movie-info"><h3>${m.title}</h3><button class="play-btn" onclick="openVideo(${m.id})">Fragman ƒ∞zle</button></div>`;
            container.appendChild(card);
        });
    }

    function loadMore() { currentPage++; fetchMovies(); }

    async function openVideo(id) {
        const lang = document.getElementById('ui-lang').value;
        const res = await fetch(`https://api.themoviedb.org/3/movie/${id}/videos?api_key=${API_KEY}&language=${lang}`);
        const data = await res.json();
        let video = data.results.find(v => v.type === 'Trailer') || data.results[0];
        if(video) {
            document.getElementById('player').innerHTML = `<iframe src="https://www.youtube.com/embed/${video.key}?autoplay=1" allowfullscreen></iframe>`;
            document.getElementById('v-modal').style.display = 'block';
            document.body.style.overflow = 'hidden';
            history.pushState({modal: true}, "");
        } else { alert("Fragman bulunamadƒ±."); }
    }

    function closeVideo() { document.getElementById('v-modal').style.display = 'none'; document.getElementById('player').innerHTML = ''; document.body.style.overflow = 'auto'; }
    window.onpopstate = () => closeVideo();
    window.onload = () => initApp(true);
</script>
</body>
</html>
